{% extends "base.html" %}

{% block title %}AgriBot - AgriHelper{% endblock %}

{% block content %}
<div class="container py-5">
    <h2 class="text-center mb-5" style="color: #28a745;">AgriBot</h2>

    <!-- Formulaire pour poser des questions -->
    <div class="row justify-content-center">
        <div class="col-md-6 text-center">
            <form id="chatbot-form" method="POST">
                <input type="text" name="question" id="question" class="form-control mb-3" placeholder="Posez votre question ici" required>
                <button type="submit" class="btn btn-success">Envoyer</button>
            </form>
            <div id="chatbot-response" class="mt-3"></div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    // Script pour envoyer la question via AJAX
    $("#chatbot-form").on("submit", function(e) {
        e.preventDefault();
        const question = $("#question").val();

        $.ajax({
            url: "/agribot",
            type: "POST",
            data: { question: question },
            success: function(response) {
                if (response.error) {
                    $("#chatbot-response").html(`<strong>Erreur :</strong> ${response.error}`);
                } else {
                    $("#chatbot-response").html(`<strong>Réponse :</strong> ${response.response}`);
                }
            },
            error: function() {
                $("#chatbot-response").html("<strong>Erreur :</strong> Impossible de générer une réponse.");
            }
        });
    });
</script>
{% endblock %}